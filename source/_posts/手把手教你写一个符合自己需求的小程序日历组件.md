---
layout: post
title: æ‰‹æŠŠæ‰‹æ•™ä½ å†™ä¸€ä¸ªç¬¦åˆè‡ªå·±éœ€æ±‚çš„å°ç¨‹åºæ—¥å†ç»„ä»¶
tags: å°ç¨‹åº
category: å°ç¨‹åº
description: å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬ç”Ÿæ´»ä¸­ä¼šæœ‰å„ç§æ‰“å¡çš„æƒ…å†µï¼Œæ¯”å¦‚keepçš„è¿åŠ¨æ‰“å¡ã€å•è¯çš„å­¦ä¹ æ‰“å¡å’Œå„ç§ç­¾åˆ°æ‰“å¡æˆ–è€…é…’åº—çš„å…¥ä½æ—¶é—´é€‰æ‹©ï¼Œè¿™æ—¶å€™å°±éœ€è¦æˆ‘ä»¬ä¹¦å†™ä¸€ä¸ªæ—¥å†ç»„ä»¶æ¥å¤„ç†æˆ‘ä»¬è¿™ç§éœ€æ±‚ã€‚
date: 2020/06/08
---

# å‰è¨€

å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬ç”Ÿæ´»ä¸­ä¼šæœ‰å„ç§æ‰“å¡çš„æƒ…å†µï¼Œæ¯”å¦‚ keep çš„è¿åŠ¨æ‰“å¡ã€å•è¯çš„å­¦ä¹ æ‰“å¡å’Œå„ç§ç­¾åˆ°æ‰“å¡æˆ–è€…é…’åº—çš„å…¥ä½æ—¶é—´é€‰æ‹©ï¼Œè¿™æ—¶å€™å°±éœ€è¦æˆ‘ä»¬ä¹¦å†™ä¸€ä¸ªæ—¥å†ç»„ä»¶æ¥å¤„ç†æˆ‘ä»¬è¿™ç§éœ€æ±‚ã€‚

ä½†æ˜¯æ›´å¤šæ—¶å€™ï¼Œæˆ‘ä»¬éƒ½æ˜¯ç½‘ä¸Šæ‰¾ä¸€ä¸ªæ’ä»¶ç›´æ¥å¥—ç”¨äº†ï¼Œæœ‰æ²¡æœ‰æƒ³è¿‡è‡ªå·±å®ç°ä¸€ä¸‹å‘¢ï¼Ÿå¦‚æœæœ‰ï¼Œä½†æ˜¯æ„Ÿè§‰ä¸å¤ªä¼šçš„è¯ï¼Œæ¥ä¸‹æ¥è·Ÿç€æˆ‘ä¸€èµ·å®ç°ç¬¦åˆè‡ªå·±éœ€æ±‚çš„æ—¥å†å§

# å‡†å¤‡å·¥ä½œ

å› ä¸ºæˆ‘ä»¬æ˜¯å°ç¨‹åºæ—¥å†å˜›ï¼Œæ‰€ä»¥å¿…ä¸å¯å°‘çš„è‚¯å®šæ˜¯å¾®ä¿¡å¼€å‘è€…å·¥å…·å•¦ã€‚é¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

```
|-- calendar
    |-- app.js
    |-- app.json
    |-- app.wxss
    |-- project.config.json
    |-- sitemap.json
    |-- components
    |   |-- calendar
    |       |-- index.js
    |       |-- index.json
    |       |-- index.wxml
    |       |-- index.wxss
    |-- pages
        |-- index
            |-- index.js
            |-- index.json
            |-- index.wxml
            |-- index.wxss
```

ä½¿ç”¨ `git` ä¸‹è½½ç©ºç™½æ¨¡æ¿:

```bash
git clone -b calendar  https://gitee.com/gating/demo.git
```

> ps: ä¸‹é¢æ­¥éª¤æœ‰ç‚¹å•°å—¦ï¼Œå¦‚æœçœ‹ç›®å½•ç»“æ„å°±èƒ½æ‡‚çš„è¯å°±ä¸éœ€è¦è·Ÿç€æ­¥éª¤å•¦

1. æ–°å»ºä¸€ä¸ªåä¸º`calendar`çš„ç©ºæ–‡ä»¶å¤¹

2. æ‰“å¡`å¾®ä¿¡å¼€å‘è€…å·¥å…·`ï¼Œæ–°å¢é¡¹ç›®ï¼Œé€‰ä¸­åˆšåˆšåˆ›å»ºçš„`calendar`æ–‡ä»¶å¤¹ï¼Œå¼€å‘æ¨¡å¼é€‰ä¸­å°ç¨‹åºï¼ŒAppID ä½¿ç”¨æµ‹è¯•å·å³å¯ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š
   ![æ–°å»ºcalendaré¡¹ç›®](https://cdn.JsDelivr.net/gh/GATING/blog_imgs/2020-06-08/calendar01.jpg)

3. åˆ›å»ºå®Œåï¼Œå¼€å‘è€…å·¥å…·ä¼šé»˜è®¤å¸®æˆ‘ä»¬ç”Ÿæˆé»˜è®¤çš„ä»£ç ï¼Œæˆ‘ä»¬åœ¨å½“å‰æ–‡ä»¶å¤¹æ–°å¢`components`æ–‡ä»¶å®¶ï¼Œå†åœ¨`components`æ–‡ä»¶å¤¹ä¸­æ–°å¢`calendar`æ–‡ä»¶å¤¹ï¼Œå†ä»å½“å‰æ–‡ä»¶å¤¹æ–°å¢åä¸º`index`çš„ç»„ä»¶ï¼Œå¦‚å›¾ï¼š

   ![æ–°å»ºcalendarç»„ä»¶](https://cdn.JsDelivr.net/gh/GATING/blog_imgs/2020-06-08/calendar02.jpg)

> ps:å› ä¸ºå¼€å‘è€…å·¥å…·ä¼šé»˜è®¤ç”Ÿæˆåˆå§‹ä»£ç ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨ä»–åˆ›å»ºç»„ä»¶æ¯”è¾ƒæ–¹ä¾¿

4. åˆ é™¤ä¸€äº›å’Œæœ¬æ¬¡åšæ–‡æ— å…³çš„ä»£ç ï¼Œæ¯”å¦‚`app.js`ä¸­çš„æœ¬åœ°ç¼“å­˜èƒ½åŠ›ï¼Œå…·ä½“å‚è€ƒç©ºç™½æ¨¡æ¿

# ç¼–å†™ä»£ç 

æ¥ä¸‹æ¥ç¼–å†™ä»£ç éƒ¨åˆ†æˆ‘ä»¬ç›´æ¥åœ¨`VSCode`ç¼–å†™ï¼Œå› ä¸º`å¾®ä¿¡å¼€å‘è€…å·¥å…·`å®åœ¨å¤ªã€‚ã€‚ã€‚- -æ‰€ä»¥è¿˜æ˜¯ä½¿ç”¨`VSCode`ç¼–å†™æ¯”è¾ƒåˆé€‚

## æ€è€ƒä¸€ä¸‹

æƒ³è¦å®ç°æ—¥å†ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å‡ ä¸ªå°çŸ¥è¯†ï¼š

1. æ ¹æ®å¸¸è¯†ï¼Œæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªæœˆæœ€å°‘æœ‰ 28 å¤©ï¼Œæœ€å¤šæœ‰ 31 å¤©ï¼Œä¸€å‘¨æœ‰ 7 å¤©ï¼Œé‚£ä¹ˆå°±å¯ä»¥æœ‰ 5 æ’ï¼Œä½†å¦‚æœæœ‰ä¸€ä¸ªæœˆçš„ç¬¬ä¸€å¤©ä¸ºæ˜ŸæœŸå…­ä¸”å½“æœˆæœ‰ 31 å¤©ï¼Œé‚£ä¹ˆä»–å°±ä¼šæœ‰ 6 æ’æ ¼å­æ‰å¯¹ã€‚æ¯”å¦‚`2020å¹´8æœˆ`ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š

   ![2020å¹´8æœˆ](https://cdn.JsDelivr.net/gh/GATING/blog_imgs/2020-06-08/calendar03.jpg)

2) æˆ‘ä»¬éœ€è¦çŸ¥é“ï¼Œå½“æœˆçš„ç¬¬ä¸€å¤©æ˜¯å‘¨å‡ 

3) æˆ‘ä»¬éœ€è¦çŸ¥é“ï¼Œå½“æœˆæœ‰å¤šå°‘å¤©

4) æœ€é‡è¦çš„æ˜¯å°ç¨‹åºæ²¡æœ‰ DOM æ“ä½œæ¦‚å¿µï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½åŠ¨æ€å¾€å½“æœˆç¬¬ä¸€å¤©æ’å…¥æ ¼å­ï¼Œæ‰€ä»¥åªèƒ½æ ¹æ®ç¬¬ä¸€å¤©æ˜¯å‘¨å‡ å¾ªç¯æ’å…¥æ ¼å­

çŸ¥é“ä»¥ä¸Šå››ç‚¹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–å†™æˆ‘ä»¬çš„ä»£ç å•¦

é¦–å…ˆï¼Œç¬¬äºŒç¬¬ä¸‰ç‚¹æ˜¯æœ€ç®€å•çš„ï¼Œæˆ‘å…ˆä¹¦å†™ç¬¬äºŒç¬¬ä¸‰ç‚¹ï¼Œæ€ä¹ˆè·å–å½“å‰æ˜¯å‘¨å‡ å‘¢ï¼Ÿå…¶å®`js`çš„`Date`å¯¹è±¡ç›´æ¥æœ‰ç°æˆçš„æ–¹æ³•ï¼Œæˆ‘ä»¬ç›´æ¥æ‹¿æ¥ç”¨å°±å¥½äº†

```js
console.log("ä»Šå¤©æ˜¯æ˜ŸæœŸ" + new Date().getDay());
```

æˆ‘æƒ³æœ‰ç‚¹å°éš¾åº¦çš„æ˜¯ç¬¬ä¸‰ç‚¹ï¼Œè·å–å½“æœˆæœ‰å¤šå°‘å¤©ï¼Œå› ä¸ºä½ æƒ³ï¼Œå…¶ä»–çš„æœˆä»½çš„å¤©æ•°æ˜¯å›ºå®šçš„ï¼Œå”¯ç‹¬ 2 æœˆï¼Œåœ¨å¹³å¹´å’Œé—°å¹´çš„ä¸åŒå¹´ä»½ä¸­ï¼Œ2 æœˆçš„å¤©æ•°ä¹Ÿæ˜¯ä¸åŒçš„ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰ç®€å•çš„æ–¹æ³•è·å–å½“æœˆæœ‰å¤šå°‘å¤©å‘¢ï¼Œå…¶å®ä¹Ÿæ˜¯æœ‰çš„ï¼Œ`Date`å®ä¾‹ä¸­çš„`getDate`å°±å¯ä»¥å®ç°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœäº†

```js
// è·å–ä¸€ä¸ªæœˆæœ‰å¤šå°‘å¤©
const getMonthDays = (year, month) => {
  let days = new Date(year, month + 1, 0).getDate();
  return days;
};
```

æˆ‘ä»¬é€šè¿‡ `Date` çš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¼  0 å°±å¯ä»¥è·å–ä¸Šä¸ªæœˆçš„æœ€åä¸€å¤©ï¼Œæœ€åé€šè¿‡ `getDate()` è·å–å®ƒçš„æ—¥æœŸå°±å¯ä»¥å¯¹åº”æˆ‘ä»¬å½“æœˆçš„å¤©æ•°ï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦æˆ‘ä»¬è‡ªå·±å¤„ç†å¹³å¹´å’Œé—°å¹´çš„ 2 æœˆæœ‰å¤šå°‘å¤©äº†

> æ˜¯ä¸æ˜¯åˆå­¦åˆ°äº†å°çŸ¥è¯†ç‚¹å‘¢ï¼Ÿ

è§£å†³äº† 2.3 ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾€ä¸‹ä¹¦å†™æˆ‘ä»¬çš„æ—¥å†äº†ã€‚

ä¼—æ‰€å‘¨çŸ¥ï¼Œå°ç¨‹åºè§„å®šå®½åº¦ä¸º`750rpx`([å°ºå¯¸å•ä½](https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxss.html))ï¼Œè€Œæˆ‘ä»¬çš„ä¸€å‘¨æœ‰ 7 å¤©ï¼Œå³ 7 æ ¼ï¼Œé‚£ä¹ˆå°±æ˜¯æ¯ä¸ªæ ¼å­çš„å®½åº¦ä¸º`107rpx`ï¼Œä¸å»ºè®®ä½¿ç”¨å°æ•°ï¼Œå› ä¸º rpx è®¡ç®—çš„æ—¶å€™ï¼Œé‡åˆ°å°æ•°ä¼šå­˜åœ¨å°‘é‡åå·®ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨`flex`å¸ƒå±€è§£å†³ã€‚

æ‰€ä»¥æ¥ä¸‹æ¥å°±å¯ä»¥å†™æˆ‘ä»¬çš„å¸ƒå±€å’Œç”Ÿæˆæˆ‘ä»¬çš„æ•°æ®å•¦ï¼Œä»ä¸Šé¢æˆ‘ä»¬åˆ†æäº†ï¼Œæˆ‘ä»¬æœ‰ 6 æ’æ ¼å­ï¼Œä¸€æ’æœ‰ 7 ä¸ªï¼Œä¹Ÿå°±æ˜¯ä¸€å…± 42 ä¸ªæ ¼å­ã€‚å³éœ€è¦éå† 42 æ¬¡

å…ˆå®šä¹‰ä¸€ä¸‹æˆ‘ä»¬æ‰€éœ€è¦çš„æ•°æ®ï¼Œä¾¿äºæˆ‘ä»¬åç»­æ“ä½œï¼š

```json
[
  {
    "dataStr": "2020/06/08",
    "day": "08",
    "month": "08",
    "otherMonth": false,
    "today": true,
    "year": 2020
  }
]
```

> è¿™é‡Œæˆ‘åªå®šä¹‰ä¸ªå‡ ä¸ªç®€å•çš„åŸºæœ¬æ•°æ®ï¼Œå¦‚æœæœ‰ä¸åŒçš„ä¸šåŠ¡åœºæ™¯å¯ä»¥è‡ªè¡Œæ·»åŠ åŸºç¡€æ•°æ®

### å° tips

IOS ç«¯çš„æ—¥æœŸæ ¼å¼å¿…é¡»ä¸º`/`æ‰å¯ä»¥è½¬åŒ–ä¸ºæ—¥æœŸæ ¼å¼ï¼Œæ¯”å¦‚`2018/07/08`ï¼Œè€Œ`2018-07-08`åˆ™è¿”å›`Invalid Date`ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠ`-`éƒ½æ›¿æ¢ä¸º`/`ã€‚

ä¸å•å•æ˜¯å°ç¨‹åºï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼Œsafari éƒ½æ˜¯ä¸€æ ·çš„ã€‚

## æ­£å¼å¼€å§‹ç¼–å†™ä»£ç 

é‚£ä¹ˆå°±å¯ä»¥å†™æˆ‘ä»¬çš„ js ä»£ç äº†ï¼Œåœ¨ `components -> calendar`ç›®å½•ä¸‹æ–°å»º`utils.js`æ–‡ä»¶ï¼Œä¹¦å†™æˆ‘ä»¬åˆ›å»ºæ•°æ®çš„åŸºç¡€æ–¹æ³•ï¼š

```js
/**
 * è·å–å½“æœˆæœ‰å¤šå°‘å¤©
 * @param {String | Number} year => å¹´
 * @param {String | Number} month => æœˆ
 */
const getMonthDays = (year, month) => {
  let days = new Date(year, month + 1, 0).getDate();
  return days;
};
/**
 * è¡¥0
 * @param {String | Number} num
 */
const toDou = (num) => {
  return num > 9 ? num : "0" + num;
};

/**
 * è½¬æ¢ä¸ºæ—¥æœŸæ ¼å¼
 * @param {*} date
 */
const transformDate = (date) => {
  if (!(date instanceof Date)) {
    date = new Date(date);
  }
  return date;
};
/**
 * è·å–å½“å‰æ—¥æœŸçš„å¹´æœˆæ—¥
 * @param {any} date => æ—¥æœŸå¯¹è±¡
 */
const getDateObj = (date) => {
  date = transformDate(date);
  var year = date.getFullYear();
  var month = date.getMonth() + 1;
  var day = date.getDate();
  return {
    year,
    month,
    day,
    dataStr: `${year}/${toDou(month)}/${toDou(day)}`,
  };
};

/**
 * è·å–å½“æœˆ1å·çš„æ—¶é—´æˆ³
 * @param {Date} date => æ—¥æœŸå¯¹è±¡
 */
const startOfMonth = (date) => {
  return date.setDate(1);
};

// è·å–ä»Šå¤©ï¼Œå¯¼å‡ºä¾›ç»„ä»¶ä½œä¸ºé»˜è®¤å€¼ä½¿ç”¨
const { dataStr } = getDateObj(new Date());

/**
 * ç”Ÿæˆæ—¥å†æ•°æ®
 * @param {Date} date => æ—¥æœŸå¯¹è±¡
 */
const getDate = (date) => {
  date = transformDate(date);
  // è®¡ç®—éœ€è¦è¡¥çš„æ ¼å­
  let dist;
  const { year, month } = getDateObj(date);
  // è·å–å½“æœˆæœ‰å¤šå°‘å¤©
  const days = getMonthDays(year, month - 1);
  // è·å–å½“å‰æ—¥æœŸæ˜¯æ˜ŸæœŸå‡ 
  let currentDate = new Date(startOfMonth(date)).getDay();
  // ä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œä¸€å‘¨çš„ç¬¬ä¸€å¤©æ—¶æ˜ŸæœŸå¤©ï¼Œè€Œæˆ‘ä»¬åšçš„æ—¥å†æ˜ŸæœŸå¤©æ˜¯æ”¾åœ¨æœ€åçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œéœ€è¦æ”¹ä¸€ä¸‹å€¼
  if (currentDate == 0) {
    currentDate = 7;
  }
  dist = currentDate - 1;
  currentDate -= 2;
  const res = [];
  for (let i = 0; i < 42; i++) {
    // æ˜¯å¦ä¸æ˜¯å½“å‰æœˆ
    const otherMonth = i >= dist + days || i <= currentDate;
    const date = new Date(year, month - 1, -currentDate + i);
    const dateObj = getDateObj(date);
    res.push({
      ...dateObj,
      today: dataStr === dateObj.dataStr,
      otherMonth,
    });
  }
  return res;
};

module.exports = {
  getMonthDays,
  toDou,
  getDateObj,
  startOfMonth,
  getDate,
  dataStr,
  transformDate,
};
```

è¿™é‡Œä»£ç éƒ½æ¯”è¾ƒç®€å•ï¼Œæ³¨é‡Šä¹Ÿæœ‰å†™ï¼Œæ‰€ä»¥å°±ä¸è¯¦ç»†è§£é‡Šäº†ï¼Œå¦‚æœ‰é—®é¢˜å°±è¯„è®ºï¼Œæˆ‘çœ‹åˆ°ä¼šç¬¬ä¸€æ—¶é—´å›å¤çš„ã€‚ã€‚ã€‚ã€‚

åœ¨ `components -> calendar -> index.js` å¼•å…¥ä¸€ä¸‹ `utils.js` æ–‡ä»¶ï¼Œç„¶ååœ¨`created`è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ‰“å°ä¸€ä¸‹æˆ‘ä»¬çš„åŸºç¡€æ•°æ®ï¼Œçœ‹æ˜¯å¦ç¬¦åˆé¢„æœŸï¼š

![](https://cdn.JsDelivr.net/gh/GATING/blog_imgs/2020-06-08/calendar04.jpg)

å¦‚æœä½ æ‰“å°çš„å’Œæˆ‘æ‰“å°çš„ä¸€è‡´ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ„‰å¿«çš„å†™æˆ‘ä»¬ç»„ä»¶çš„ç•Œé¢å•¦ ğŸ˜„

å› ä¸ºå¸ƒå±€å¤§å¤šæ•°éƒ½æ˜¯æ ·å¼æ–¹é¢çš„é—®é¢˜ï¼Œè¿™é‡Œå°±ä¸å¤šè®²è§£å•¦ï¼Œæˆ‘æƒ³å¤§å®¶åº”è¯¥éƒ½ä¼šçš„ï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥ç²˜è´´ä»£ç å•¦ï¼Œä¸»è¦éƒ¨åˆ†æˆ‘å°±è®²è§£ä¸€ä¸‹

`index.wxml`ä»£ç å¦‚ä¸‹ï¼š

```xml
<view class="calendar-wrapper">
  <view class="calendar-controller">
    <view class="calendar-picker">
      <text class="arrow left" bindtap="prevMonth"></text>
      <picker
        mode='date'
        fields='month'
        end="2999-12-31"
        start="1970-01-01"
        value="{{monthFormat}}"
        bindchange="dateChange"
      >
        <text class="month-format">{{monthFormat}}</text>
      </picker>
      <text class="arrow right" bindtap="nextMonth"></text>
    </view>
  </view>
  <view class="calendar-header">
    <view class="item" wx:for="{{week}}" wx:key="*this">{{item}}</view>
  </view>
  <view class="calendar-container">
    <view class="item {{item.today?'today':''}} {{item.otherMonth?'other-month':''}}" wx:for="{{calendar}}" wx:key="dataStr">
      <text>{{item.day}}</text>
    </view>
  </view>
</view>
```

`index.wxss`ä»£ç å¦‚ä¸‹ï¼š

```css
.calendar-container,
.calendar-controller,
.calendar-header,
.calendar-picker,
.calendar-container .item,
.calendar-header .item {
  display: flex;
  align-items: center;
  line-height: normal;
}
.calendar-container,
.calendar-controller,
.calendar-header {
  justify-content: space-around;
  flex-wrap: wrap;
}
.calendar-container .item,
.calendar-header .item {
  justify-content: center;
  width: 107rpx;
  font-size: 28rpx;
  height: 80rpx;
}
.calendar-header .item {
  color: #666;
}
.calendar-container .item {
  color: #111;
}
.calendar-container .item.other-month {
  color: #999;
}
.calendar-container .item.today {
  color: #6190e8;
  font-weight: 600;
}
.calendar-picker {
  font-size: 30rpx;
  color: #111;
  padding: 20rpx 0;
}
.month-format {
  margin: 0 30rpx;
}
.arrow {
  display: flex;
  padding: 10rpx 15rpx;
  background: #f7f8fc;
}
.arrow::after {
  content: "";
  width: 14rpx;
  height: 14rpx;
  border-top: 4rpx solid #ccc;
  border-left: 4rpx solid #ccc;
}
.arrow.left::after {
  transform: rotateY(-45deg) rotate(-47deg) skew(5deg);
}
.arrow.right::after {
  transform: rotateY(-135deg) rotate(-47deg) skew(5deg);
}
```

`index.js`ä»£ç å¦‚ä¸‹ï¼š

```js
// components/calendar/index.js
const { getDate, dataStr, getDateObj } = require("./utils");

const getDateStr = (dataStr) => dataStr.slice(0, -3).replace("/", "-");
Component({
  /**
   * ç»„ä»¶çš„å±æ€§åˆ—è¡¨
   */
  properties: {},

  /**
   * ç»„ä»¶çš„åˆå§‹æ•°æ®
   */
  data: {
    week: ["ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­", "æ—¥"],
    calendar: getDate(new Date()),
    monthFormat: getDateStr(dataStr),
  },

  /**
   * ç»„ä»¶çš„æ–¹æ³•åˆ—è¡¨
   */
  methods: {
    dateChange(e) {
      const monthFormat = e.detail.value;
      this.setData({
        monthFormat,
      });
    },
    // ä¸Šä¸ªæœˆæ—¥æœŸ
    prevMonth() {
      const [year, month] = this.data.monthFormat.split("-");
      const { dataStr } = getDateObj(
        new Date(year, month, 1).setMonth(month - 2)
      );
      this.setData({
        monthFormat: getDateStr(dataStr),
        calendar: getDate(new Date(dataStr)),
      });
    },
    // ä¸‹ä¸ªæœˆæ—¥æœŸ
    nextMonth() {
      const [year, month] = this.data.monthFormat.split("-");
      const { dataStr } = getDateObj(new Date(year, month, 1));
      this.setData({
        monthFormat: getDateStr(dataStr),
        calendar: getDate(new Date(dataStr)),
      });
    },
  },
  created() {},
});
```

> è¿™é‡Œçš„ä¸»è¦è¿·æƒ‘ç‚¹å°±æ˜¯æœˆä»½ï¼Œå› ä¸ºæˆ‘ä»¬å¾—åˆ°çš„æœˆä»½æ˜¯è½¬æ¢åçš„ï¼ˆå³æœˆä»½+1ï¼‰ï¼Œè€Œ`js`ä¸­çš„æœˆä»½æ˜¯ä» 0 å¼€å§‹çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è·å–ä¸Šä¸ªæœˆçš„æ—¶å€™æœˆä»½å°±éœ€è¦`-2`æ‰èƒ½å®ç°æˆ‘ä»¬è¦çš„æ•ˆæœï¼Œè€Œè·å–ä¸‹ä¸ªæœˆçš„æ—¶å€™ï¼Œå› ä¸ºæœ¬èº«æˆ‘ä»¬æœˆä»½æœ¬èº«å°±`+1`äº†ï¼Œæ‰€ä»¥ä¸éœ€è¦è¿›è¡Œæ“ä½œã€‚

ä¹¦å†™å®Œæˆå¸ƒå±€åï¼Œå¤§æ¦‚ä¼šå¾—å‡ºä¸‹é¢è¿™ä¸ªæ—¥å†ï¼š

![](https://cdn.JsDelivr.net/gh/GATING/blog_imgs/2020-06-08/calendar05.jpg)

å†™åˆ°è¿™é‡Œï¼Œå…¶å®æ•´ä¸ªæ—¥å†çš„é›å½¢å·²ç»å‡ºæ¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡`picker`æ¢ï¼Œå¯ä»¥é€šè¿‡ç‚¹å‡»åˆ‡æ¢ï¼Œä¹Ÿç®—ä¸€ä¸ªç›¸å¯¹å¯ä»¥ä½¿ç”¨çš„æ—¥å†ç»„ä»¶å•¦ ğŸ˜

ä½†æ˜¯å…¶å®è¿˜æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œæ¯•ç«Ÿï¼Œæˆ‘ä»¬è¿**æ‰‹åŠ¿å·¦å³æ»‘åŠ¨åˆ‡æ¢æ—¥å†**è¿™ä¸ªåŠŸèƒ½éƒ½æ²¡æœ‰ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥å°±å®Œå–„æˆ‘ä»¬è¿™ä¸ªæ—¥å†å§

## æ— ç¼æ»‘åŠ¨æ€è€ƒ

ä½ æƒ³ï¼Œæ—¢ç„¶è¦åšå·¦å³æ»‘åŠ¨åˆ‡æ¢äº†ï¼Œè‚¯å®šå¾—æ— ç¼å§ï¼Ÿæ—¢ç„¶å¾—æ— ç¼ï¼Œè‚¯å®šä¸èƒ½ç”Ÿæˆå¤šä»½å§ï¼Ÿé‚£ä¹ˆæ€ä¹ˆæ‰èƒ½ç”¨æœ€å°‘çš„ DOM åšåˆ°æ— ç¼å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æˆ‘ä»¬åªéœ€è¦åœ¨æˆ‘ä»¬å¯è§†èŒƒå›´å†…ç”Ÿæˆ DOM ç»“æ„å³å¯ï¼Œå³æˆ‘ä»¬çš„å¯è§†èŒƒå›´å°±æ˜¯ä¸‰ä»½ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š

![](https://cdn.JsDelivr.net/gh/GATING/blog_imgs/2020-06-08/calendar06.gif)

æ—¢ç„¶è¯´åˆ°äº†**å·¦å³æ»‘åŠ¨**ï¼Œè‚¯å®šå°‘ä¸äº†æˆ‘ä»¬å¼ºå¤§çš„`swiper`ç»„ä»¶å•¦ï¼Œæˆ‘ä»¬è¿™æ¬¡çš„æ—¥å†ç»„ä»¶å°±æ˜¯å»ºç«‹åœ¨`swiper`ç»„ä»¶ä¸‹å®ç°çš„,æ—¢ç„¶ç”¨åˆ°äº†`swiper`ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„å¸ƒå±€è‚¯å®šéœ€è¦è¿›è¡Œå°æ”¹ï¼Œæ•°æ®ç»“æ„ä¹Ÿæ˜¯ï¼Œéœ€è¦è¿›è¡Œå°æ”¹åŠ¨ã€‚

åˆšæ‰è¯´äº†ï¼Œæˆ‘ä»¬çš„å¯æ˜¯èŒƒå›´æ˜¯ä¸‰ä»½ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ•°æ®ç»“æ„å°±å˜æˆäº†é•¿åº¦ä¸ºä¸‰çš„æ•°ç»„ï¼Œå³ï¼š

```js
{
  "calendarArr": [calendar, calendar, calendar]
}
```

ç•Œé¢ä¹Ÿæ˜¯ï¼Œæˆ‘ä»¬æ–°å¢ä¸€ä¸ª`swiper`ç»„ä»¶ï¼Œç„¶åéå†`calendarArr`è¿™ä¸ªæ•°æ®ï¼Œ

```xml
<view class="calendar-wrapper">
    <view class="calendar-controller">
      <view class="calendar-picker">
        <text class="arrow left" bindtap="prevMonth"></text>
        <picker
          mode='date'
          fields='month'
          end="2999-12-31"
          start="1970-01-01"
          value="{{monthFormat}}"
          bindchange="dateChange"
        >
          <text class="month-format">{{monthFormat}}</text>
        </picker>
        <text class="arrow right" bindtap="nextMonth"></text>
      </view>
    </view>
    <view class="calendar-header">
      <view class="item" wx:for="{{week}}" wx:key="*this">{{item}}</view>
    </view>
    <swiper
      circular
      class="calendar-swiper"
      current="{{current}}"
      duration="{{duration}}"
      vertical="{{isVertical}}"
      skip-hidden-item-layout
      bindchange="swiperChange"
      bindanimationfinish="swiperAnimateFinish"
      bindtouchstart="swipeTouchStart"
      bindtouchend="swipeTouchEnd"
    >
      <block wx:for="{{calendarArr}}" wx:for-item="calendar" wx:key="index">
        <swiper-item>
          <view class="calendar-container">
            <view class="item {{item.today?'today':''}} {{item.otherMonth?'other-month':''}}" wx:for="{{calendar}}" wx:key="dataStr">
              <text>{{item.day}}</text>
            </view>
          </view>
        </swiper-item>
      </block>
    </swiper>
</view>
```

æ ·å¼çš„è¯ï¼Œå› ä¸º`swiper`ç»„ä»¶æœ‰é»˜è®¤æ ·å¼ï¼Œé«˜åº¦æ˜¯`150px`ï¼Œè€Œæˆ‘ä»¬è¿™é‡Œ`6 * 80rpx`ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸‹å®ƒçš„é»˜è®¤æ ·å¼ï¼Œå³æ·»åŠ ä¸‹é¢çš„ css å³å¯:

```css
.calendar-swiper {
  height: 480rpx;
}
```

ä¹‹åå°±æ˜¯ä¹¦å†™æˆ‘ä»¬çš„é€»è¾‘å•¦ï¼Œä»å¸ƒå±€å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç”¨äº†`touchstart`å’Œ`touchend`ï¼Œæœ¬æ„å…¶å®å°±æ˜¯åˆ¤æ–­æˆ‘ä»¬æ˜¯å‘å·¦æ»‘è¿˜æ˜¯å‘å³æ»‘ï¼ˆå‘ä¸Šåˆ’è¿˜æ˜¯å‘ä¸‹æ»‘ï¼‰ï¼Œæ¥åˆ‡æ¢æˆ‘ä»¬çš„æœˆä»½

## å¦‚ä½•åŒºåˆ†å·¦æ»‘å³æ»‘ï¼ˆä¸Šæ»‘ä¸‹æ»‘ï¼‰

1. éœ€è¦å®šä¸¤ä¸ªå˜é‡ä¾›æˆ‘ä»¬åŒºåˆ†æ˜¯æ»‘åŠ¨çš„æ–¹å‘ï¼Œä¸€ä¸ªæ˜¯`swipeStartPoint`,ä¸€ä¸ªæ˜¯`isPrevMonth`

2. æ—¢ç„¶æˆ‘ä»¬è¯´åˆ°äº†æ— ç¼ï¼Œé‚£ä¹ˆè‚¯å®šç”¨æˆ·å°±ä¼šæ»‘åŠ¨å¤šæ¬¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿéœ€è¦ä¸€ä¸ªå€¼æ¥è®¡ç®—ç”¨æˆ·æ»‘åŠ¨çš„æ¬¡æ•°ï¼Œæˆ‘ä»¬å®šä¹‰ä¸º`changeCount`

3. è¿™ç‚¹ä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€ç”¨é€šè¿‡å½“å‰æˆ‘ä»¬æ»‘åŠ¨åˆ°ç¬¬å‡ ä¸ª`swiper-item`ï¼Œæ¥ä¿®æ”¹æˆ‘ä»¬çš„ä¸Šä¸ªæœˆå’Œä¸‹ä¸ªæœˆçš„æ•°æ®ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“ï¼Œå½“å‰çš„`swiper-item`è‚¯å®šæ˜¯ä¸­é—´çš„é‚£ä¸ªæœˆä»½ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿéœ€è¦ä¸€ä¸ªå˜é‡æ¥æ ‡è®°æˆ‘ä»¬å½“å‰çš„æ˜¯ç¬¬å‡ ä¸ªï¼Œæˆ‘ä»¬å®šä¹‰ä¸º`currentSwiperIndex`ï¼Œé’ˆå¯¹äºè¿™é‡Œçš„é€»è¾‘ï¼Œæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼š

```js
// å‡è®¾æˆ‘ä»¬ç°åœ¨æ˜¯6æœˆï¼Œé‚£ä¹ˆæ•°æ®å°±æ˜¯
let calendar = [5, 6, 7];
// é‚£ä¹ˆæˆ‘ä»¬çš„ currentSwiperIndex è¿™æ—¶æ˜¯ç­‰äº1çš„
// å‡è®¾æˆ‘æ»‘åŠ¨äº†äº”æœˆï¼ŒcurrentSwiperIndex è¿™æ—¶å˜æˆ0äº†,æˆ‘ä»¬çš„æœˆä»½è¿˜æ˜¯ä¸å˜
// ä½†æ˜¯æˆ‘ä»¬çš„é€»è¾‘å°±å‘ç”Ÿæ”¹å˜äº†
// è¿™æ—¶å€™çš„ä¸Šä¸ªæœˆå˜æˆäº†7ï¼Œä¸‹ä¸ªæœˆå˜æˆ6ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ currentSwiperIndex çš„å€¼æ¥åŠ¨æ€ä¿®æ”¹ä»–ï¼Œå³
calendar = [5, 6, 7];
// åŠä¼ªä»£ç 
const calendarArr = [];
const now = getDate(currentDate);
const prev = getDate(this.getPrevMonth(dataStr));
const next = getDate(this.getNextMonth(dataStr));
const prevIndex = currentSwiperIndex === 0 ? 2 : currentSwiperIndex - 1;
const nextIndex = currentSwiperIndex === 2 ? 0 : currentSwiperIndex + 1;
calendarArr[prevIndex] = prev;
calendarArr[nextIndex] = next;
calendarArr[currentSwiperIndex] = now;
```

ç†æ¸…æ¥šä¸Šé¢æ‰€æœ‰çš„ï¼ŒåŸºæœ¬ä¸Šæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹é‡æ„æˆ‘ä»¬çš„ä»£ç äº†

## æ­£å¼ä¹¦å†™æˆ‘ä»¬å¯æ»‘åŠ¨çš„æ—¥å†ç»„ä»¶

å…ˆå®šä¹‰æˆ‘ä»¬ä¹‹å‰çš„æ‰€è¯´çš„å˜é‡ï¼Œå’Œå¤„ç†è¿™äº›å˜é‡çš„æ–¹æ³•

```js
// å½“å‰çš„ç´¢å¼•å€¼ï¼Œå¿…é¡»ä»ç¬¬ä¸€ä¸ªå¼€å§‹ï¼Œå› ä¸ºè¿™æ ·æˆ‘ä»¬æ‰èƒ½å®ç°è§†é‡å†…çš„æ— ç¼
let currentSwiperIndex = 1,
  generateDate = dataStr, // å½“å‰æ—¶é—´
  swipeStartPoint = 0, // æ»‘åŠ¨çš„åæ ‡
  isPrevMonth = false, // æ˜¯å¦å‘å³æ»‘åŠ¨
  changeCount = 0; // æ»‘åŠ¨çš„æ¬¡æ•°

Component({
  // ...
  methods: {
    // è®¾ç½®å½“å‰çš„ç´¢å¼•å€¼
    swiperChange(e) {
      const { current, source } = e.detail;
      if (source === "touch") {
        currentSwiperIndex = current;
        changeCount += 1;
      }
    },
    // è·å–æ‰‹æŒ‡åˆšæŒ‰ä¸‹çš„åæ ‡
    swipeTouchStart(e) {
      const { clientY, clientX } = e.changedTouches[0];
      swipeStartPoint = this.data.isVertical ? clientY : clientX;
    },
    // è·å–æ‰‹æŒ‡æ¾å¼€æ—¶çš„åæ ‡
    swipeTouchEnd(e) {
      const { clientY, clientX } = e.changedTouches[0];
      isPrevMonth = this.data.isVertical
        ? clientY - swipeStartPoint > 0
        : clientX - swipeStartPoint > 0;
    },
  },
  // ...
});
```

ç„¶åå®šä¹‰ä¸€ä¸ªå¤„ç†æˆ‘ä»¬æ—¥å†æ•°æ®çš„æ–¹æ³•ï¼Œå› ä¸ºæˆ‘ä»¬æ—¥å†æ–¹æ³•æ˜¯æ¯ä¸ªæ—¶é—´éƒ½éœ€è¦ä½¿ç”¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰ä¸ªå…¬ç”¨çš„æ–¹æ³•ï¼Œ

```js
Component({
  // ...
  methods: {
    // è®¾ç½®ä¸Šä¸ªæœˆçš„æ—¶é—´
    getPrevMonth(monthFormat) {
      const [year, month] = monthFormat.split(/\-|\//);
      const { dataStr } = getDateObj(
        new Date(year, month, 1).setMonth(month - 2)
      );
      return dataStr;
    },
    // è®¾ç½®ä¸‹ä¸ªæœˆçš„æ—¶é—´
    getNextMonth(monthFormat) {
      const [year, month] = monthFormat.split(/\-|\//);
      const { dataStr } = getDateObj(new Date(year, month, 1));
      return dataStr;
    },
    // ç”Ÿæˆæ—¥å†æ•°ç»„
    generatorCalendar(date) {
      const calendarArr = [];
      // è½¬æ¢ä¸º Date å®ä¾‹
      const currentDate = transformDate(date);
      // è·å–å½“å‰æ—¶é—´çš„æ—¥å†æ•°æ®
      const now = getDate(currentDate);
      // è·å–å½“å‰æ—¶é—´çš„å­—ç¬¦ä¸²
      const { dataStr } = getDateObj(currentDate);
      // è·å–ä¸Šä¸ªæœˆçš„æ—¥å†æ•°æ®
      const prev = getDate(this.getPrevMonth(dataStr));
      // è·å–ä¸‹ä¸ªæœˆçš„æ—¥å†æ•°æ®
      const next = getDate(this.getNextMonth(dataStr));
      // è®¾ç½®æ—¥å†æ•°æ®
      const prevIndex = currentSwiperIndex === 0 ? 2 : currentSwiperIndex - 1;
      const nextIndex = currentSwiperIndex === 2 ? 0 : currentSwiperIndex + 1;
      calendarArr[prevIndex] = prev;
      calendarArr[nextIndex] = next;
      calendarArr[currentSwiperIndex] = now;
      this.setData({
        calendarArr,
        monthFormat: getDateStr(dataStr),
      });
    },
  },
  // ...
});
```

> ps: å› ä¸ºè¿™é‡Œä¸Šä¸‹æœˆä»½ä¹Ÿå¯ä»¥å…¬ç”¨ï¼Œæ‰€ä»¥å•ç‹¬æå–å‡ºæ¥ä¾›å…¶ä»–æ–¹æ³•ä½¿ç”¨

æœ€åï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨åŠ¨ç”»ç»“æŸçš„æ—¶å€™è®¾ç½®æ—¥å†æ•°æ®å³å¯ï¼Œå³ï¼š

```js
Component({
  // ...
  methods: {
    // åŠ¨ç”»ç»“æŸåè®©æ»‘åŠ¨çš„æ¬¡æ•°ç½®0
    swiperAnimateFinish() {
      const { year, month } = getDateObj(generateDate);
      const monthDist = isPrevMonth ? -changeCount : changeCount;
      generateDate = new Date(year, month + monthDist - 1);
      // æ¸…ç©ºæ»‘åŠ¨æ¬¡æ•°
      changeCount = 0;
      this.generatorCalendar(generateDate);
    },
  },
  // ...
});
```

æ•´åˆèµ·æ¥å°±æ˜¯ï¼š

```js
// components/calendar/index.js
const { getDate, dataStr, getDateObj, transformDate } = require("./utils");
const getDateStr = (dataStr) => dataStr.slice(0, 7).replace("/", "-");
// å½“å‰çš„ç´¢å¼•å€¼ï¼Œå¿…é¡»ä»ç¬¬ä¸€ä¸ªå¼€å§‹ï¼Œå› ä¸ºè¿™æ ·æˆ‘ä»¬æ‰èƒ½å®ç°è§†é‡å†…çš„æ— ç¼
let currentSwiperIndex = 1,
  generateDate = dataStr, // å½“å‰æ—¶é—´
  swipeStartPoint = 0, // æ»‘åŠ¨çš„åæ ‡
  isPrevMonth = false, // æ˜¯å¦å‘å³æ»‘åŠ¨
  changeCount = 0; // æ»‘åŠ¨çš„æ¬¡æ•°
Component({
  /**
   * ç»„ä»¶çš„å±æ€§åˆ—è¡¨
   */
  properties: {
    duration: {
      type: String,
      value: 500,
    },
    isVertical: {
      type: Boolean,
      value: false,
    },
  },

  /**
   * ç»„ä»¶çš„åˆå§‹æ•°æ®
   */
  data: {
    week: ["ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­", "æ—¥"],
    current: 1,
    calendarArr: [],
    monthFormat: getDateStr(dataStr),
  },

  /**
   * ç»„ä»¶çš„æ–¹æ³•åˆ—è¡¨
   */
  methods: {
    // è®¾ç½®ä¸Šä¸ªæœˆçš„æ—¶é—´
    getPrevMonth(monthFormat) {
      const [year, month] = monthFormat.split(/\-|\//);
      const { dataStr } = getDateObj(
        new Date(year, month, 1).setMonth(month - 2)
      );
      return dataStr;
    },
    // è®¾ç½®ä¸‹ä¸ªæœˆçš„æ—¶é—´
    getNextMonth(monthFormat) {
      const [year, month] = monthFormat.split(/\-|\//);
      const { dataStr } = getDateObj(new Date(year, month, 1));
      return dataStr;
    },
    // ç”Ÿæˆæ—¥å†æ•°ç»„
    generatorCalendar(date) {
      const calendarArr = [];
      // è½¬æ¢ä¸º Date å®ä¾‹
      const currentDate = transformDate(date);
      // è·å–å½“å‰æ—¶é—´çš„æ—¥å†æ•°æ®
      const now = getDate(currentDate);
      // è·å–å½“å‰æ—¶é—´çš„å­—ç¬¦ä¸²
      const { dataStr } = getDateObj(currentDate);
      // è·å–ä¸Šä¸ªæœˆçš„æ—¥å†æ•°æ®
      const prev = getDate(this.getPrevMonth(dataStr));
      // è·å–ä¸‹ä¸ªæœˆçš„æ—¥å†æ•°æ®
      const next = getDate(this.getNextMonth(dataStr));
      // è®¾ç½®æ—¥å†æ•°æ®
      const prevIndex = currentSwiperIndex === 0 ? 2 : currentSwiperIndex - 1;
      const nextIndex = currentSwiperIndex === 2 ? 0 : currentSwiperIndex + 1;
      calendarArr[prevIndex] = prev;
      calendarArr[nextIndex] = next;
      calendarArr[currentSwiperIndex] = now;
      this.setData({
        calendarArr,
        monthFormat: getDateStr(dataStr),
      });
      // é€šçŸ¥çˆ¶ç»„ä»¶
      this.triggerEvent("change", this.data.monthFormat);
    },
    // è®¾ç½®å½“å‰çš„ç´¢å¼•å€¼
    swiperChange(e) {
      const { current, source } = e.detail;
      if (source === "touch") {
        currentSwiperIndex = current;
        changeCount += 1;
      }
    },
    // åŠ¨ç”»ç»“æŸåè®©æ»‘åŠ¨çš„æ¬¡æ•°ç½®0
    swiperAnimateFinish() {
      const { year, month } = getDateObj(generateDate);
      const monthDist = isPrevMonth ? -changeCount : changeCount;
      generateDate = new Date(year, month + monthDist - 1);
      // æ¸…ç©ºæ»‘åŠ¨æ¬¡æ•°
      changeCount = 0;
      this.generatorCalendar(generateDate);
    },
    // è·å–æ‰‹æŒ‡åˆšæŒ‰ä¸‹çš„åæ ‡
    swipeTouchStart(e) {
      const { clientY, clientX } = e.changedTouches[0];
      swipeStartPoint = this.data.isVertical ? clientY : clientX;
    },
    // è·å–æ‰‹æŒ‡æ¾å¼€æ—¶çš„åæ ‡
    swipeTouchEnd(e) {
      const { clientY, clientX } = e.changedTouches[0];
      isPrevMonth = this.data.isVertical
        ? clientY - swipeStartPoint > 0
        : clientX - swipeStartPoint > 0;
    },

    dateChange(e) {
      const monthFormat = e.detail.value;
      this.setData({
        monthFormat,
      });
      generateDate = getDateStr(monthFormat);
      this.generatorCalendar(generateDate);
    },

    // ä¸Šä¸ªæœˆæ—¥æœŸ
    prevMonth() {
      this.setData({
        monthFormat: this.getPrevMonth(this.data.monthFormat),
      });
      this.generatorCalendar(this.data.monthFormat);
    },
    // ä¸‹ä¸ªæœˆæ—¥æœŸ
    nextMonth() {
      this.setData({
        monthFormat: this.getNextMonth(this.data.monthFormat),
      });
      this.generatorCalendar(this.data.monthFormat);
    },
  },
  ready() {
    this.generatorCalendar(generateDate);
  },
});
```

é¡µé¢ä¸­ä½¿ç”¨ï¼Œ

```xml
<calendar bindchange="calendarChange"></calendar>
```

```js
Page({
  calendarChange(e) {
    console.log(e.detail);
  },
});
```

å†™åˆ°è¿™é‡Œï¼Œå…¶å®åŸºæœ¬ä¸Šæ•´ä¸ªæ—¥å†å°±å·²ç»å®Œæˆäº†ï¼Œä½†ä¹Ÿè®¸ä½ ä¼šè¯´ï¼Œå…¶å®è¿˜æœ‰å¾ˆå¤šåŠŸèƒ½æ²¡æœ‰å®Œå–„ï¼Œæ¯”å¦‚:

- è·³è½¬åˆ°æŒ‡å®šåˆ°æ—¶é—´

- èŒƒå›´é€‰æ‹©

- ç‚¹å‡»æ ‡è®°æ—¶é—´ç­‰ç­‰

- ...

å…¶å®æˆ‘è§‰å¾—å¤šæ•°æ˜¯è®¾ç½®æ ·å¼é—®é¢˜ï¼Œæ¯”å¦‚æ ‡è®°æ—¶é—´è¿™ä¸ªåŠŸèƒ½ï¼Œå…¶å®æœ‰è¿™ä¸ªåŸºç¡€çš„ä¾‹å­ï¼Œæˆ‘æƒ³å¤§å®¶å¾€é‡Œé¢åŠ åŠŸèƒ½åº”è¯¥éƒ½å¯ä»¥å®ç°çš„ï¼Œæ‰€ä»¥æˆ‘å°±ä¸ä¸€æ­¥ä¸€æ­¥çš„å¾€é‡Œé¢å†™äº†

å¦‚æœåç»­æœ‰æ—¶é—´æˆ‘ä¼šå¾€è¿™ä¸ªé¡¹ç›®å¤šåŠ ä¸€ä¸‹æ–°åŠŸèƒ½çš„

> [gitee åœ°å€](https://gitee.com/gating/demo/tree/master/calendar),[github åœ°å€](https://github.com/GATING/demo/tree/master/calendar)

# æœ€å

æ„Ÿè§‰å„ä½è§‚ä¼—è€çˆ·çš„è§‚çœ‹ï¼Œå¸Œæœ›ä½ èƒ½æœ‰æ‰€æ”¶è· ğŸ˜
