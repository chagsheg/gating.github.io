---
layout: post
title: nodeå®ç°å›¾ç‰‡å››å‘¨å¡«å……é€æ˜åŒºåŸŸ
tags: node
category: è®°å½•
description: ä¸çŸ¥é“ä½ ä»¬æœ‰æ²¡æœ‰é‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œå†™å°ç¨‹åºçš„æ—¶å€™ï¼Œæ–‡æ¡£é‡Œé¢æ¨èçš„ tabbar å›¾æ ‡æ˜¯ 81 * 81ï¼Œä½†æ˜¯å®é™…æ•ˆæœå›¾ç‰‡åˆåå¤§ï¼Œè€Œä¸”é…ç½®é¡¹ä¹Ÿæ²¡æœ‰å¯è°ƒèŠ‚çš„é…ç½®ã€‚é‚£ä¹ˆæ€ä¹ˆæ ·è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿä¸€èˆ¬éƒ½æ˜¯æ‰¾ UI å°å§å§æŠŠ icon å››è¾¹æ·»åŠ é€æ˜å¡«å……æ¥è°ƒæ•´ icon å¤§å°çš„ã€‚
date: 2020/06/10
---

# å‰è¨€

ä¸çŸ¥é“ä½ ä»¬æœ‰æ²¡æœ‰é‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œå†™å°ç¨‹åºçš„æ—¶å€™ï¼Œæ–‡æ¡£é‡Œé¢æ¨èçš„ tabbar å›¾æ ‡æ˜¯ `81 * 81`ï¼Œä½†æ˜¯å®é™…æ•ˆæœå›¾ç‰‡åˆåå¤§ï¼Œè€Œä¸”é…ç½®é¡¹ä¹Ÿæ²¡æœ‰å¯è°ƒèŠ‚çš„é…ç½®ã€‚é‚£ä¹ˆæ€ä¹ˆæ ·è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿä¸€èˆ¬éƒ½æ˜¯æ‰¾ UI å°å§å§æŠŠ icon å››è¾¹æ·»åŠ é€æ˜å¡«å……æ¥è°ƒæ•´ icon å¤§å°çš„ã€‚

ä½†æ˜¯å¦‚æœæ²¡æœ‰ ui å°å§å§çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¦å¦‚ä½•è§£å†³å‘¢ï¼Ÿè™½ç„¶å¯ä»¥é€šè¿‡`ps`çš„æ‰¹å¤„ç†è§£å†³ï¼Œä½†æ¯•ç«Ÿæˆ‘ä»¬æ˜¯`ç¨‹åºçŒ¿`ï¼Œå½“ç„¶æ˜¯é€šè¿‡ä»£ç æ¥è§£å†³è¿™ç§å°é—®é¢˜å•¦ã€‚æ‰€ä»¥ï¼Œé—²è¯ä¸å¤šè¯´å•¦ï¼Œå¼€å§‹å†™æˆ‘ä»¬çš„ä»£ç å•¦

# ç®€å•æ­å»ºä¸€ä¸‹

- æ–°å»ºä¸€ä¸ª `canvas-blank-area` ç›®å½•

- åˆå§‹åŒ–ä¸€ä¸ª`node`é¡¹ç›®å·¥ç¨‹

  ```bash
  npm init -y
  ```

- å®‰è£…ä¾èµ–ï¼Œè¿™é‡Œä¸»è¦ç”¨åˆ°äº†ä¸‰ä¸ªä¾èµ–ï¼Œåˆ†åˆ«æ˜¯`å¤„ç†å›¾ç‰‡`ã€`è·å–å›¾ç‰‡å¤§å°`ã€`å‹ç¼©æˆzipæ–‡ä»¶`

  ```bash
  npm i canvas image-size archiver -S
  ```

æ˜¯ä¸æ˜¯å¾ˆçœ¼ç†Ÿï¼Œè¿™ä¾èµ–å’Œæˆ‘ä¹‹å‰çš„é‚£ç¯‡[node å®ç°å›¾ç‰‡åˆ†å‰²](https://gatings.cn/2020-03-11/node%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E5%88%86%E5%89%B2/)åšå®¢ä¸€æ¨¡ä¸€æ ·å—ï¼Ÿæ²¡é”™ï¼Œå°±æ˜¯ä¸€æ‘¸ä¸€æ ·ï¼Œæˆ‘ä»¬å†æ¬¡é€šè¿‡ `canvas`è¿™ä¸ªåº“æ¥å¤„ç†æˆ‘ä»¬çš„å°éœ€æ±‚ã€‚

> ä¸å¾—ä¸è¯´è¿™ä¸ª`canvas`åº“çœŸçš„æ˜¯æŒºå¥½ç”¨çš„ã€‚

# ç®€å•çš„ä½¿ç”¨ä¸€ä¸‹

æœ‰äº†ä¸Šä¸€ç¯‡æˆ‘ä»¬ä½¿ç”¨`canvas`çš„ç»éªŒï¼Œå…¶å®ä¹¦å†™ä»£ç å¯¹äºæˆ‘ä»¬æ¥è¯´åº”è¯¥æ˜¯ä¸éš¾äº†ï¼Œæˆ‘ä»¬çœ‹çœ‹æˆ‘å®ç°çš„æ•ˆæœï¼š

![nodeå›¾ç‰‡å››å‘¨å¡«å……é€æ˜åŒºåŸŸ](https://cdn.JsDelivr.net/gh/GATING/blog_imgs/2020-06-10/blank-area.png)

çœ‹åˆ°è¿™é‡Œï¼Œæ˜¯ä¸æ˜¯æƒ³è·ƒè·ƒæ¬²è¯•å•¦ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å°è¯•å†™ä¸€ä¸‹æˆ‘ä»¬çš„ä»£ç 

```js
// åˆ›å»ºå†™å…¥æµ
const { createWriteStream } = require("fs");
// è·å–æ–‡ä»¶å
const { basename } = require("path");
// å‹ç¼©æ–‡ä»¶
const archiver = require("archiver");
// å¯¼å…¥canvasåº“ï¼Œç”¨äºè£å‰ªå›¾ç‰‡
const { createCanvas, loadImage } = require("canvas");
// è·å–å›¾ç‰‡å¤§å°
const sizeOf = require("image-size");
// æ‰¹é‡è·å–è·¯å¾„
const glob = require("glob");
!(async () => {
  const paths = glob.sync("./images/*");
  // å‹ç¼©æˆzip
  const archive = archiver("zip", {
    zlib: { level: 9 }, // Sets the compression level.
  });
  // è¾“å‡ºåˆ°å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„ blank-area.zip
  const output = createWriteStream(__dirname + "/blank-area.zip");
  archive.pipe(output);
  for (let i = 0; i < paths.length; i++) {
    const path = paths[i];
    const image = await loadImage(path);
    const { width, height } = await sizeOf(path);
    const canvas = createCanvas(81, 81);
    const ctx = canvas.getContext("2d");
    ctx.drawImage(image, (81 - width) / 2, (81 - height) / 2);
    archive.append(canvas.toBuffer(), { name: `${basename(path)}` });
  }
  archive.finalize();
})();
```

è¿™ä¹ˆä¸€çœ‹ï¼Œæ˜¯ä¸æ˜¯æ¯”æˆ‘ä»¬ä¹‹å‰é‚£ä¸ªåˆ†å‰²å›¾ç‰‡çš„ä»£ç ç®€å•å¤šäº†ï¼Œæˆ‘ç›¸ä¿¡å°ä¼™ä¼´ä»¬è‚¯å®šæ—©å°±è‡ªå·±å†™å‡ºæ¥å•¦~~ğŸ˜Š

æœ€åï¼Œè·‘ä¸€ä¸‹æˆ‘ä»¬å†™çš„ç¨‹åºï¼Œå½“å‰ç›®å½•å°±ä¼šå¤šå‡ºäº†ä¸€ä¸ª `blank-area.zip` çš„å‹ç¼©åŒ…ï¼Œè§£å‹å‡ºæ¥å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„å›¾ç‰‡å•¦ ğŸ˜Š

> [gitee åœ°å€](https://gitee.com/gating/demo/tree/master/canvas-blank-area),[github åœ°å€](https://github.com/GATING/demo/tree/master/canvas-blank-area)

# æœ€å

æ„Ÿè°¢å„ä½è§‚ä¼—è€çˆ·çš„è§‚çœ‹ O(âˆ©_âˆ©)O
